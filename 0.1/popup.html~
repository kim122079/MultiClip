<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <style>
		body {
			font-size: 12px;
			font-weight: bold;
			color: #000000;
			line-height: 1.5;
	   }
    </style>
    <script language="javascript" type="text/javascript" src="jquery-1.3.2.js"></script>
    <script>
      var logging = false;
      var key1 = "clip1";
      var key2 = "clip2";
      var key3 = "clip3";
      var clip1 = "<empty>";
      var clip2 = "<empty>";
      var clip3 = "<empty>";

      function init() {
        clip1 = getValue(key1);
        clip2 = getValue(key2);
        clip3 = getValue(key3);
        updateValues();
      }
      
      

      function store(text) {
        logAllKeyValues();

        var oldText = chrome.extension.getBackgroundPage().getItem(key1);
	
        shiftClips(text);

        logAllKeyValues();

        chrome.extension.getBackgroundPage().setItem(key1,clip1);
        chrome.extension.getBackgroundPage().setItem(key2,clip2);
        chrome.extension.getBackgroundPage().setItem(key3,clip3);
      }
      

      function getValue(key) {
        return chrome.extension.getBackgroundPage().getItem(key);
      }

      function shiftClips(newClip) {
        clip3 = clip2;
        clip2 = clip1;
        clip1 = newClip;
      }

      function updateValues() {
        $('#cl1').text(clip1);
        $('#cl2').text(clip2);
        $('#cl3').text(clip3);
      }
      
      function logAllKeyValues() {
        log(key1 + ":" + clip1);
	    log(key2 + ":" + clip2);
        log(key3 + ":" + clip3);
      }
      
      function clearStorage() {
	      try {
	         chrome.extension.getBackgroundPage().flushStorage();
	      }catch(e) {
	        console.log("error while flushing local storage");
	        console.log(e);
	      }

	      $('#cl1').innerHTML = "";
	      $('#cl2').innerHTML = "";
	      $('#cl3').innerHTML = "";
	      clip1 = "null";
	      clip2 = "null";
	      clip3 = "null";
      }

    </script>
  </head>
  <body onload='init()'>
      <div class="wrapper">
  	  <h1>Recently clipped text snippets</h1>
          <ul class="clipList">
	      <li id="cl1">Last Value clipped 1</li>
	      <li id="cl2">Last Value clipped 2</li>
	      <li id="cl3">Last Value clipped 3</li>
          </ul>
	  <a onclick='clearStorage()'>flush clipboard!</a>
      </div>
  </body>
</html>
